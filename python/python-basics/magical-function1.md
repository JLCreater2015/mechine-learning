# 魔法函数（一）

## 1、魔法函数 <a id="1&#x9B54;&#x6CD5;&#x51FD;&#x6570;"></a>

所谓魔法函数（Magic Methods），是Python的一种高级语法，允许你在类中自定义函数（函数名格式一般为**xx**），并绑定到类的特殊方法中。比如在类A中自定义**str**\(\)函数，则在调用str\(A\(\)\)时，会自动调用**str**\(\)函数，并返回相应的结果。在我们平时的使用中，可能经常使用**init**函数和**del**函数，其实这也是魔法函数的一种。

1. 魔法函数是python内置的，具有双下划线开头结尾的特性。
2. 自定义的类中使用魔法函数，该类就具有了该魔法函数的功能，比如使用iter魔法函数，该类就具有迭代功能。
3. 使用魔法函数实现高灵活性，实现自己所需要的独特的数据类型。

## 2、字符串表示 <a id="2&#x5B57;&#x7B26;&#x4E32;&#x8868;&#x793A;"></a>

```python
object.__repr__()   # 格式化字符串式样，主用开发模式下
object.__str__()    # 常用的字符串，格式化字符串
```

**程序清单 1：**

```python
class magic:
    def __init__(self, num):
        self.num = num
    def __str__(self):
        return (self.num + '\n')*3
a = magic('这是 magic...')
print a
```

输出：

```text
这是 magic...
这是 magic...
这是 magic...
```

这里使用print a和使用 print a.**str**\(\)效果是一样的。同理repr\(a\)和a.**repr**\(\)

区别：

```text
__repr__ 目的是为了表示清楚，是为开发者准备的。
__str__ 目的是可读性好，是为使用者准备的。
__repr__ 应该尽可能的表示出一个对象来源的类以及继承关系，方便程序员们了解这个对象。而 __str__ 就简单的表示对象，而不要让不懂编程的以为输出的是 bug。
```

**同时定义 repr 方法和 str 方法时，print\(\) 方法会调用 str 方法。**

## 3、集合序列 <a id="3&#x96C6;&#x5408;&#x5E8F;&#x5217;"></a>

```text
__len__()
__getitem__()
__setitem__()
__delitem__()
__contains__()
```

## 4、迭代 <a id="4&#x8FED;&#x4EE3;"></a>

```text
__iter__()
__next__()
```

## 5、可调用 <a id="5&#x53EF;&#x8C03;&#x7528;"></a>

## 6、with上下文管理 <a id="6with&#x4E0A;&#x4E0B;&#x6587;&#x7BA1;&#x7406;"></a>

## 7、数值转换 <a id="7&#x6570;&#x503C;&#x8F6C;&#x6362;"></a>

## 8、元类相关 <a id="8&#x5143;&#x7C7B;&#x76F8;&#x5173;"></a>

## 9、属性相关 <a id="9&#x5C5E;&#x6027;&#x76F8;&#x5173;"></a>

## 10、属性描述符 <a id="10&#x5C5E;&#x6027;&#x63CF;&#x8FF0;&#x7B26;"></a>

